points(OverviewDF$num[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==0&OverviewDF$num<=297],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==0&OverviewDF$num<=297],pch=21,bg=brewer.pal(11, "Spectral")[11])
points(45,2*10^-5,pch=21,bg=brewer.pal(11, "Spectral")[11])
text(48,2*10^-5,pos=4,"A/T/C, syn, no CpG")
#T #SYN #no CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==0&OverviewDF$num<=297],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==0&OverviewDF$num<=297],pch=21,bg=brewer.pal(11, "Spectral")[11])
#C #SYN #no CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="c"&OverviewDF$makesCpG==0&OverviewDF$num<=297],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="c"&OverviewDF$makesCpG==0&OverviewDF$num<=297],pch=21,bg=brewer.pal(11, "Spectral")[11])
#A #SYN #CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==1&OverviewDF$num<=297],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==1&OverviewDF$num<=297],pch=24,bg=brewer.pal(11, "Spectral")[10])
points(45,1.4*10^-5,pch=24,bg=brewer.pal(11, "Spectral")[10])
text(48,1.4*10^-5,pos=4,"A/T, syn, CpG")
#T #SYN #CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==1&OverviewDF$num<=297],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==1&OverviewDF$num<=297],pch=24,bg=brewer.pal(11, "Spectral")[10])
#G #SYN #no CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="g"&OverviewDF$makesCpG==0&OverviewDF$num<=297],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="g"&OverviewDF$makesCpG==0&OverviewDF$num<=297],pch=25,bg=brewer.pal(11, "Spectral")[8],col=brewer.pal(11, "RdYlGn")[11])
points(45,1*10^-5,pch=25,bg=brewer.pal(11, "Spectral")[8],col=brewer.pal(11, "RdYlGn")[11])
text(48,1*10^-5,pos=4,"G, syn")
#A #NONSYN #no CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==0&OverviewDF$num<=297&OverviewDF$bigChange==0],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==0&OverviewDF$num<=297&OverviewDF$bigChange==0],pch=21,col=2,bg=brewer.pal(11, "Spectral")[7])
points(100,2*10^-5,pch=21,bg=brewer.pal(11, "Spectral")[7],col=2)
text(103,2*10^-5,pos=4,"A/T, non-syn, no drastic AA change")
#T #NONSYN #no CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==0&OverviewDF$num<=297&OverviewDF$bigChange==0],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==0&OverviewDF$num<=297&OverviewDF$bigChange==0],pch=21,col=2,bg=brewer.pal(11, "Spectral")[7])
#A #NONSYN #CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==1&OverviewDF$num<=297&OverviewDF$bigChange==0],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==1&OverviewDF$num<=297&OverviewDF$bigChange==0],pch=21,col=2,bg=brewer.pal(11, "Spectral")[7])
#T #NONSYN #CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==1&OverviewDF$num<=297&OverviewDF$bigChange==0],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==1&OverviewDF$num<=297&OverviewDF$bigChange==0],pch=21,col=2,bg=brewer.pal(11, "Spectral")[7])
#With big AA change
#A #NONSYN #no CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==0&OverviewDF$num<=297&OverviewDF$bigChange==1],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==0&OverviewDF$num<=297&OverviewDF$bigChange==1],pch=22,col=2,bg=brewer.pal(11, "Spectral")[5])
points(100,1.4*10^-5,pch=22,bg=brewer.pal(11, "Spectral")[5],col=2)
text(103,1.4*10^-5,pos=4,"A/T, non-syn, drastic AA change")
#T #NONSYN #no CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==0&OverviewDF$num<=297&OverviewDF$bigChange==1],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==0&OverviewDF$num<=297&OverviewDF$bigChange==1],pch=22,col=2,bg=brewer.pal(11, "Spectral")[5])
#A #NONSYN #CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==1&OverviewDF$num<=297&OverviewDF$bigChange==1],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==1&OverviewDF$num<=297&OverviewDF$bigChange==1],pch=22,col=2,bg=brewer.pal(11, "Spectral")[5])
#T #NONSYN #CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==1&OverviewDF$num<=297&OverviewDF$bigChange==1],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==1&OverviewDF$num<=297&OverviewDF$bigChange==1],pch=22,col=2,bg=brewer.pal(11, "Spectral")[5])
#no big AA change
#C #NONSYN no big AA change
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="c"&OverviewDF$makesCpG==0&OverviewDF$num<=297&OverviewDF$bigChange==0],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="c"&OverviewDF$makesCpG==0&OverviewDF$num<=297&OverviewDF$bigChange==0],pch=21,col=2,bg=brewer.pal(11, "Spectral")[3])
points(100,1*10^-5,pch=21,bg=brewer.pal(11, "Spectral")[3],col=2)
text(103,1*10^-5,pos=4,"C, non-syn, no drastic AA change")
#G #NONSYN no big AA change
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="g"&OverviewDF$makesCpG==0&OverviewDF$num<=297&OverviewDF$bigChange==0],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="g"&OverviewDF$makesCpG==0&OverviewDF$num<=297&OverviewDF$bigChange==0],pch=21,col=2,bg=brewer.pal(11, "Spectral")[1])
points(200,2*10^-5,pch=21,bg=brewer.pal(11, "Spectral")[1],col=2)
text(203,2*10^-5,pos=4,"G, non-syn, no drastic AA change")
#C #NONSYN bigchange
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="c"&OverviewDF$makesCpG==0&OverviewDF$num<=297&OverviewDF$bigChange==1],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="c"&OverviewDF$makesCpG==0&OverviewDF$num<=297&OverviewDF$bigChange==1],pch=22,col=2,bg=brewer.pal(11, "Spectral")[3])
points(200,1.4*10^-5,pch=22,bg=brewer.pal(11, "Spectral")[3],col=2)
text(203,1.4*10^-5,pos=4,"C, non-syn, drastic AA change")
#G #NONSYN bigchange
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="g"&OverviewDF$makesCpG==0&OverviewDF$num<=297&OverviewDF$bigChange==1],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="g"&OverviewDF$makesCpG==0&OverviewDF$num<=297&OverviewDF$bigChange==1],pch=22,col=2,bg=brewer.pal(11, "Spectral")[1])
points(200,1*10^-5,pch=22,bg=brewer.pal(11, "Spectral")[1],col=2)
text(203,1*10^-5,pos=4,"G, non-syn, drastic AA change")
#nonsense
points(OverviewDF$num[OverviewDF$TypeOfSite=="stop"&OverviewDF$num<=297],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="stop"&OverviewDF$num<=297],pch=22,col=2,bg=1)
points(280,2*10^-5,pch=22,bg=1,col=1)
text(283,2*10^-5,pos=4,"nonsense")
#resistance
points(OverviewDF$num[OverviewDF$TypeOfSite=="res"&OverviewDF$num<=297],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="res"&OverviewDF$num<=297],pch=8,col=1,bg=1)
points(280,1.4*10^-5,pch=8,bg=1,col=1)
text(283,1.4*10^-5,pos=4,"resistance")
dev.off()
pdf("../Output/EstSelCoeffRT.pdf",width=12,height=8)
par(mfrow=c(1,1))
#make log scale
plot(OverviewDF$num[298:984],OverviewDF$EstSelCoeff[298:984],log="y",
ylab="Estimated Selection Coefficient (cost)", xlab = "Position in Protease", xaxt="n",yaxt="n",col="darkgrey",
t="c",pch=".",
ylim=c(0.9*10^-5,1))
axis(1,at=298+3*seq(20,228,by=20)-1,labels=seq(20,228,by=20))
axis(2,at=c(10^-5,10^-4,10^-3,10^-2,10^-1,10^-0),labels=c(10^-5,10^-4,10^-3,10^-2,10^-1,10^-0))
#Add colors for different types of sites
#A #SYN #no CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==0&OverviewDF$num>297],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==0&OverviewDF$num>297],pch=21,bg=brewer.pal(11, "Spectral")[11])
points(298+45,2*10^-5,pch=21,bg=brewer.pal(11, "Spectral")[11])
text(298+48,2*10^-5,pos=4,"A/T/C, syn, no CpG")
#T #SYN #no CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==0&OverviewDF$num>297],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==0&OverviewDF$num>297],pch=21,bg=brewer.pal(11, "Spectral")[11])
#C #SYN #no CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="c"&OverviewDF$makesCpG==0&OverviewDF$num>297],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="c"&OverviewDF$makesCpG==0&OverviewDF$num>297],pch=21,bg=brewer.pal(11, "Spectral")[11])
#A #SYN #CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==1&OverviewDF$num>297],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==1&OverviewDF$num>297],pch=24,bg=brewer.pal(11, "Spectral")[10])
points(298+45,1.4*10^-5,pch=24,bg=brewer.pal(11, "Spectral")[10])
text(298+48,1.4*10^-5,pos=4,"A/T, syn, CpG")
#T #SYN #CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==1&OverviewDF$num>297],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==1&OverviewDF$num>297],pch=24,bg=brewer.pal(11, "Spectral")[10])
#G #SYN #no CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="g"&OverviewDF$makesCpG==0&OverviewDF$num>297],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="g"&OverviewDF$makesCpG==0&OverviewDF$num>297],pch=25,bg=brewer.pal(11, "Spectral")[8],col=brewer.pal(11, "RdYlGn")[11])
points(298+45,1*10^-5,pch=25,bg=brewer.pal(11, "Spectral")[8],col=brewer.pal(11, "RdYlGn")[11])
text(298+48,1*10^-5,pos=4,"G, syn")
#A #NONSYN #no CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==0],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==0],pch=21,col=2,bg=brewer.pal(11, "Spectral")[7])
points(298+180,2*10^-5,pch=21,bg=brewer.pal(11, "Spectral")[7],col=2)
text(298+183,2*10^-5,pos=4,"A/T, non-syn, no drastic AA change")
#T #NONSYN #no CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==0],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==0],pch=21,col=2,bg=brewer.pal(11, "Spectral")[7])
#A #NONSYN #CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==1&OverviewDF$num>297&OverviewDF$bigChange==0],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==1&OverviewDF$num>297&OverviewDF$bigChange==0],pch=21,col=2,bg=brewer.pal(11, "Spectral")[7])
#T #NONSYN #CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==1&OverviewDF$num>297&OverviewDF$bigChange==0],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==1&OverviewDF$num>297&OverviewDF$bigChange==0],pch=21,col=2,bg=brewer.pal(11, "Spectral")[7])
#With big AA change
#A #NONSYN #no CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==1],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==1],pch=22,col=2,bg=brewer.pal(11, "Spectral")[5])
points(298+180,1.4*10^-5,pch=22,bg=brewer.pal(11, "Spectral")[5],col=2)
text(298+183,1.4*10^-5,pos=4,"A/T, non-syn, drastic AA change")
#T #NONSYN #no CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==1],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==1],pch=22,col=2,bg=brewer.pal(11, "Spectral")[5])
#A #NONSYN #CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==1&OverviewDF$num>297&OverviewDF$bigChange==1],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==1&OverviewDF$num>297&OverviewDF$bigChange==1],pch=22,col=2,bg=brewer.pal(11, "Spectral")[5])
#T #NONSYN #CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==1&OverviewDF$num>297&OverviewDF$bigChange==1],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==1&OverviewDF$num>297&OverviewDF$bigChange==1],pch=22,col=2,bg=brewer.pal(11, "Spectral")[5])
#no big AA change
#C #NONSYN no big AA change
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="c"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==0],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="c"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==0],pch=21,col=2,bg=brewer.pal(11, "Spectral")[3])
points(298+180,1*10^-5,pch=21,bg=brewer.pal(11, "Spectral")[3],col=2)
text(298+183,1*10^-5,pos=4,"C, non-syn, no drastic AA change")
#G #NONSYN no big AA change
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="g"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==0],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="g"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==0],pch=21,col=2,bg=brewer.pal(11, "Spectral")[1])
points(298+400,2*10^-5,pch=21,bg=brewer.pal(11, "Spectral")[1],col=2)
text(298+403,2*10^-5,pos=4,"G, non-syn, no drastic AA change")
#C #NONSYN bigchange
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="c"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==1],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="c"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==1],pch=22,col=2,bg=brewer.pal(11, "Spectral")[3])
points(298+400,1.4*10^-5,pch=22,bg=brewer.pal(11, "Spectral")[3],col=2)
text(298+403,1.4*10^-5,pos=4,"C, non-syn, drastic AA change")
#G #NONSYN bigchange
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="g"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==1],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="g"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==1],pch=22,col=2,bg=brewer.pal(11, "Spectral")[1])
points(298+400,1*10^-5,pch=22,bg=brewer.pal(11, "Spectral")[1],col=2)
text(298+403,1*10^-5,pos=4,"G, non-syn, drastic AA change")
#nonsense
points(OverviewDF$num[OverviewDF$TypeOfSite=="stop"&OverviewDF$num>297],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="stop"&OverviewDF$num>297],pch=22,col=2,bg=1)
points(298+620,2*10^-5,pch=22,bg=1,col=1)
text(298+623,2*10^-5,pos=4,"nonsense")
#resistance
points(OverviewDF$num[OverviewDF$TypeOfSite=="res"&OverviewDF$num>297],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="res"&OverviewDF$num>297],pch=8,col=1,bg=1)
points(298+620,1.4*10^-5,pch=8,bg=1,col=1)
text(298+623,1.4*10^-5,pos=4,"resistance")
dev.off()
pdf("../Output/EstSelCoeffRT.pdf",width=12,height=8)
par(mfrow=c(1,1))
#make log scale
plot(OverviewDF$num[298:984],OverviewDF$EstSelCoeff[298:984],log="y",
ylab="Estimated Selection Coefficient (cost)", xlab = "Position in Reverse Transcriptase", xaxt="n",yaxt="n",col="darkgrey",
t="c",pch=".",
ylim=c(0.9*10^-5,1))
axis(1,at=298+3*seq(20,228,by=20)-1,labels=seq(20,228,by=20))
axis(2,at=c(10^-5,10^-4,10^-3,10^-2,10^-1,10^-0),labels=c(10^-5,10^-4,10^-3,10^-2,10^-1,10^-0))
#Add colors for different types of sites
#A #SYN #no CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==0&OverviewDF$num>297],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==0&OverviewDF$num>297],pch=21,bg=brewer.pal(11, "Spectral")[11])
points(298+45,2*10^-5,pch=21,bg=brewer.pal(11, "Spectral")[11])
text(298+48,2*10^-5,pos=4,"A/T/C, syn, no CpG")
#T #SYN #no CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==0&OverviewDF$num>297],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==0&OverviewDF$num>297],pch=21,bg=brewer.pal(11, "Spectral")[11])
#C #SYN #no CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="c"&OverviewDF$makesCpG==0&OverviewDF$num>297],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="c"&OverviewDF$makesCpG==0&OverviewDF$num>297],pch=21,bg=brewer.pal(11, "Spectral")[11])
#A #SYN #CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==1&OverviewDF$num>297],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==1&OverviewDF$num>297],pch=24,bg=brewer.pal(11, "Spectral")[10])
points(298+45,1.4*10^-5,pch=24,bg=brewer.pal(11, "Spectral")[10])
text(298+48,1.4*10^-5,pos=4,"A/T, syn, CpG")
#T #SYN #CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==1&OverviewDF$num>297],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==1&OverviewDF$num>297],pch=24,bg=brewer.pal(11, "Spectral")[10])
#G #SYN #no CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="g"&OverviewDF$makesCpG==0&OverviewDF$num>297],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="syn"&OverviewDF$WTnt=="g"&OverviewDF$makesCpG==0&OverviewDF$num>297],pch=25,bg=brewer.pal(11, "Spectral")[8],col=brewer.pal(11, "RdYlGn")[11])
points(298+45,1*10^-5,pch=25,bg=brewer.pal(11, "Spectral")[8],col=brewer.pal(11, "RdYlGn")[11])
text(298+48,1*10^-5,pos=4,"G, syn")
#A #NONSYN #no CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==0],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==0],pch=21,col=2,bg=brewer.pal(11, "Spectral")[7])
points(298+180,2*10^-5,pch=21,bg=brewer.pal(11, "Spectral")[7],col=2)
text(298+183,2*10^-5,pos=4,"A/T, non-syn, no drastic AA change")
#T #NONSYN #no CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==0],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==0],pch=21,col=2,bg=brewer.pal(11, "Spectral")[7])
#A #NONSYN #CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==1&OverviewDF$num>297&OverviewDF$bigChange==0],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==1&OverviewDF$num>297&OverviewDF$bigChange==0],pch=21,col=2,bg=brewer.pal(11, "Spectral")[7])
#T #NONSYN #CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==1&OverviewDF$num>297&OverviewDF$bigChange==0],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==1&OverviewDF$num>297&OverviewDF$bigChange==0],pch=21,col=2,bg=brewer.pal(11, "Spectral")[7])
#With big AA change
#A #NONSYN #no CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==1],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==1],pch=22,col=2,bg=brewer.pal(11, "Spectral")[5])
points(298+180,1.4*10^-5,pch=22,bg=brewer.pal(11, "Spectral")[5],col=2)
text(298+183,1.4*10^-5,pos=4,"A/T, non-syn, drastic AA change")
#T #NONSYN #no CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==1],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==1],pch=22,col=2,bg=brewer.pal(11, "Spectral")[5])
#A #NONSYN #CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==1&OverviewDF$num>297&OverviewDF$bigChange==1],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="a"&OverviewDF$makesCpG==1&OverviewDF$num>297&OverviewDF$bigChange==1],pch=22,col=2,bg=brewer.pal(11, "Spectral")[5])
#T #NONSYN #CPG
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==1&OverviewDF$num>297&OverviewDF$bigChange==1],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="t"&OverviewDF$makesCpG==1&OverviewDF$num>297&OverviewDF$bigChange==1],pch=22,col=2,bg=brewer.pal(11, "Spectral")[5])
#no big AA change
#C #NONSYN no big AA change
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="c"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==0],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="c"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==0],pch=21,col=2,bg=brewer.pal(11, "Spectral")[3])
points(298+180,1*10^-5,pch=21,bg=brewer.pal(11, "Spectral")[3],col=2)
text(298+183,1*10^-5,pos=4,"C, non-syn, no drastic AA change")
#G #NONSYN no big AA change
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="g"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==0],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="g"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==0],pch=21,col=2,bg=brewer.pal(11, "Spectral")[1])
points(298+400,2*10^-5,pch=21,bg=brewer.pal(11, "Spectral")[1],col=2)
text(298+403,2*10^-5,pos=4,"G, non-syn, no drastic AA change")
#C #NONSYN bigchange
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="c"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==1],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="c"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==1],pch=22,col=2,bg=brewer.pal(11, "Spectral")[3])
points(298+400,1.4*10^-5,pch=22,bg=brewer.pal(11, "Spectral")[3],col=2)
text(298+403,1.4*10^-5,pos=4,"C, non-syn, drastic AA change")
#G #NONSYN bigchange
points(OverviewDF$num[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="g"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==1],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="nonsyn"&OverviewDF$WTnt=="g"&OverviewDF$makesCpG==0&OverviewDF$num>297&OverviewDF$bigChange==1],pch=22,col=2,bg=brewer.pal(11, "Spectral")[1])
points(298+400,1*10^-5,pch=22,bg=brewer.pal(11, "Spectral")[1],col=2)
text(298+403,1*10^-5,pos=4,"G, non-syn, drastic AA change")
#nonsense
points(OverviewDF$num[OverviewDF$TypeOfSite=="stop"&OverviewDF$num>297],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="stop"&OverviewDF$num>297],pch=22,col=2,bg=1)
points(298+620,2*10^-5,pch=22,bg=1,col=1)
text(298+623,2*10^-5,pos=4,"nonsense")
#resistance
points(OverviewDF$num[OverviewDF$TypeOfSite=="res"&OverviewDF$num>297],OverviewDF$EstSelCoeff[OverviewDF$TypeOfSite=="res"&OverviewDF$num>297],pch=8,col=1,bg=1)
points(298+620,1.4*10^-5,pch=8,bg=1,col=1)
text(298+623,1.4*10^-5,pos=4,"resistance")
dev.off()
write.csv(OverviewDF,"../Output/OverviewSelCoeff_Bacheler.csv")
read.table("../Output/freqPatTs_Bacheler.csv",sep=",",header=TRUE,row.names=1)->freqPatTs0
colMeansTs0<-apply(freqPatTs0, 2 , mean, na.rm=TRUE)
OverviewDF<-data.frame(num=1:984,colMeansTs0,TypeOfSite)
read.csv("../Data/HIVMutRates/HIVMutRates.csv")->mutrates
OverviewDF$TSmutrate<-0
OverviewDF$TSmutrate[OverviewDF$WTnt=="a"]<-mutrates$Probability[mutrates$Nucleotide.substitution=="AG"]
OverviewDF$TSmutrate[OverviewDF$WTnt=="c"]<-mutrates$Probability[mutrates$Nucleotide.substitution=="CU"]
OverviewDF$TSmutrate[OverviewDF$WTnt=="g"]<-mutrates$Probability[mutrates$Nucleotide.substitution=="GA"]
OverviewDF$TSmutrate[OverviewDF$WTnt=="t"]<-mutrates$Probability[mutrates$Nucleotide.substitution=="UC"]
for (i in 1:984){
OverviewDF$EstSelCoeff[i] = EstimatedS(OverviewDF$TSmutrate[i],OverviewDF$colMeansTs0[i])}
OverviewDF$WTnt<-consensusB
#WT AAs
OverviewDF$WTAA<-""
for (i in 1:984){
if (i%%3==1) OverviewDF$WTAA[i] = seqinr::translate(OverviewDF$WTnt[c(i,i+1,i+2)])
if (i%%3==2) OverviewDF$WTAA[i] = seqinr::translate(OverviewDF$WTnt[c(i-1,i,i+1)])
if (i%%3==0) OverviewDF$WTAA[i] = seqinr::translate(OverviewDF$WTnt[c(i-2,i-1,i)])
}
OverviewDF$MUTAA<-""
#MUT AAs
for (i in 1:984){
if (i%%3==1) OverviewDF$MUTAA[i] = seqinr::translate(c(transition(OverviewDF$WTnt[i]),OverviewDF$WTnt[c(i+1,i+2)]))
if (i%%3==2) OverviewDF$MUTAA[i] = seqinr::translate(c(OverviewDF$WTnt[c(i-1)],transition(OverviewDF$WTnt[i]),OverviewDF$WTnt[c(i+1)]))
if (i%%3==0) OverviewDF$MUTAA[i] = seqinr::translate(c(OverviewDF$WTnt[c(i-2,i-1)],transition(OverviewDF$WTnt[i])))
}
#Add whether AA change is drastic
OverviewDF$bigAAChange<-0
for(i in 1:nrow(OverviewDF)){
WT <- amCat(OverviewDF[i,'WTAA'])
MUT <- amCat(OverviewDF[i,'MUTAA'])
if (WT == MUT){ OverviewDF$bigAAChange[i] <- 0
}else{
OverviewDF$bigAAChange[i] <- 1
}
}
#Add whetehr makes CpG
OverviewDF$makesCpG <- 0
for(i in 1:nrow(OverviewDF)){
trip <- OverviewDF$WTnt[c(i-1, i, i + 1)]
if(trip[1] == "c" & trip[2] == "a" ){
OverviewDF$makesCpG[i] <- 1
}
if(trip[2] == "t" & trip[3] == "g"){
OverviewDF$makesCpG[i] <- 1
}
}
write.csv(OverviewDF,"../Output/OverviewSelCoeff_Bacheler.csv")
read.table("../Output/freqPatTs_Bacheler.csv",sep=",",header=TRUE,row.names=1)->freqPatTs0
MeanFreq<-apply(freqPatTs0, 2 , mean, na.rm=TRUE)
OverviewDF<-data.frame(num=1:984,MeanFreq,TypeOfSite)
read.csv("../Data/HIVMutRates/HIVMutRates.csv")->mutrates
OverviewDF$TSmutrate<-0
OverviewDF$TSmutrate[OverviewDF$WTnt=="a"]<-mutrates$Probability[mutrates$Nucleotide.substitution=="AG"]
OverviewDF$TSmutrate[OverviewDF$WTnt=="c"]<-mutrates$Probability[mutrates$Nucleotide.substitution=="CU"]
OverviewDF$TSmutrate[OverviewDF$WTnt=="g"]<-mutrates$Probability[mutrates$Nucleotide.substitution=="GA"]
OverviewDF$TSmutrate[OverviewDF$WTnt=="t"]<-mutrates$Probability[mutrates$Nucleotide.substitution=="UC"]
for (i in 1:984){
OverviewDF$EstSelCoeff[i] = EstimatedS(OverviewDF$TSmutrate[i],OverviewDF$MeanFreq[i])}
OverviewDF$WTnt<-consensusB
#WT AAs
OverviewDF$WTAA<-""
for (i in 1:984){
if (i%%3==1) OverviewDF$WTAA[i] = seqinr::translate(OverviewDF$WTnt[c(i,i+1,i+2)])
if (i%%3==2) OverviewDF$WTAA[i] = seqinr::translate(OverviewDF$WTnt[c(i-1,i,i+1)])
if (i%%3==0) OverviewDF$WTAA[i] = seqinr::translate(OverviewDF$WTnt[c(i-2,i-1,i)])
}
OverviewDF$MUTAA<-""
#MUT AAs
for (i in 1:984){
if (i%%3==1) OverviewDF$MUTAA[i] = seqinr::translate(c(transition(OverviewDF$WTnt[i]),OverviewDF$WTnt[c(i+1,i+2)]))
if (i%%3==2) OverviewDF$MUTAA[i] = seqinr::translate(c(OverviewDF$WTnt[c(i-1)],transition(OverviewDF$WTnt[i]),OverviewDF$WTnt[c(i+1)]))
if (i%%3==0) OverviewDF$MUTAA[i] = seqinr::translate(c(OverviewDF$WTnt[c(i-2,i-1)],transition(OverviewDF$WTnt[i])))
}
#Add whether AA change is drastic
OverviewDF$bigAAChange<-0
for(i in 1:nrow(OverviewDF)){
WT <- amCat(OverviewDF[i,'WTAA'])
MUT <- amCat(OverviewDF[i,'MUTAA'])
if (WT == MUT){ OverviewDF$bigAAChange[i] <- 0
}else{
OverviewDF$bigAAChange[i] <- 1
}
}
#Add whetehr makes CpG
OverviewDF$makesCpG <- 0
for(i in 1:nrow(OverviewDF)){
trip <- OverviewDF$WTnt[c(i-1, i, i + 1)]
if(trip[1] == "c" & trip[2] == "a" ){
OverviewDF$makesCpG[i] <- 1
}
if(trip[2] == "t" & trip[3] == "g"){
OverviewDF$makesCpG[i] <- 1
}
}
write.csv(OverviewDF,"../Output/OverviewSelCoeff_Bacheler.csv")
984-297
c(rep("Pro",297),rep("RT",687))
OverviewDF$ProRT<-c(rep("Pro",297),rep("RT",687))
write.csv(OverviewDF,"../Output/OverviewSelCoeff_Bacheler.csv")
rep(1:10,by=3)
seq(1:10,by=3)
seq(1:10,rep=3)
seq(0, 1, length.out = 11)
rep(1:10,3)
sort(rep(1:10,3))
sort(rep(1:99,3))
c(sort(rep(1:99,3)),sort(rep(1:200,3)))
(984-297)/3
OverviewDF$AAnum<-c(sort(rep(1:99,3)),sort(rep(1:229,3)))
write.csv(OverviewDF,"../Output/OverviewSelCoeff_Bacheler.csv")
table(OverviewDF$TypeOfSite)
sqrt(0.973)
sqrt(0.883)
984-297
FreqsSyn<-OverviewDF$MeanFreq[OverviewDF$TypeOfSite=="syn"]
FreqsSyn
FreqsSyn<-OverviewDF$MeanFreq[OverviewDF$TypeOfSite=="syn"]
FreqsNonSyn<-OverviewDF$MeanFreq[OverviewDF$TypeOfSite=="nonsyn"]
FreqsStop<-OverviewDF$MeanFreq[OverviewDF$TypeOfSite=="stop"]
wilcox.test(FreqsSyn, FreqsNonSyn,alternative = "less", paired = FALSE)
wilcox.test(FreqsNonSyn,FreqsStop,alternative = "greater", paired = FALSE)
wilcox.test(FreqsSyn, FreqsNonSyn,alternative = "greater", paired = FALSE)
wilcox.test(SelCoeffnonSyn_a_noCpG_noBigC, SelCoeffnonSyn_g_noCpG_noBigC,alternative = "less", paired = FALSE)
wilcox.test(SelCoeffnonSyn_a_noCpG_noBigC, SelCoeffnonSyn_c_noCpG_noBigC,alternative = "less", paired = FALSE)
wilcox.test(SelCoeffSyn_a_noCpG, SelCoeffSyn_g_noCpG,alternative = "less", paired = FALSE)
lehman_threshold_mean<-read.csv('../Output/OverviewSelCoeffLehman.csv')
stanford_threshold <-read.csv('../Output/freqPatTs_Stanford.csv')
bacheler_threshold_mean<-read.csv('../Output/OverviewSelCoeff_Bacheler.csv')
compare_dataset_colmeans<-names(compare_dataset)[grep('colM',names(compare_dataset))]
for (compare_dataset in list(bacheler_threshold_mean,zanini_threshold_mean,lehman_threshold_mean))
{
# identify the column with the frequency values
compare_dataset_colmeans<-names(compare_dataset)[grep('colM',names(compare_dataset))]
#remove first 13 amino acid  positions of protease
stanford_compare<-cbind(stanford_threshold,compare_dataset)
#remove stop and res positions
stanford_compare_14<-stanford_compare[40:nrow(stanford_compare),]
stanford_compare_14_stopres<-stanford_compare_14[stanford_compare_14$TypeOfSite!='res' & stanford_compare_14$TypeOfSite!='stop' ,]
stanford_compare_14_stopres$TypeOfSite<-factor(stanford_compare_14_stopres$TypeOfSite)
stanford_compare_14_stopres$TypeOfSite<-relevel(stanford_compare_14_stopres$TypeOfSite,"syn")
# color setting for plot
#66C2A5 is green    ==> should be for synonymous
#FC8D62 is red
library(RColorBrewer)
cols_all <- brewer.pal(nlevels(stanford_compare_14_stopres$TypeOfSite),"Set2")
ç
}
stanford_threshold <-read.csv('../Output/freqPatTs_Stanford.csv')
bacheler_threshold_mean<-read.csv('../Output/OverviewSelCoeff_Bacheler.csv')
setwd("~/Documents/Git/bachelerProject/Comparison-stanford_vs_bacheler-april2016")
source("../Rscripts/baseRscript.R")
OverviewDFBach$StanfordFreqs<-t(read.csv("subtypeB-frequencies_stanford_pr_rt_naive.csv"))[1:length(OverviewDFBach[,1])]
OverviewDFBach<-read.csv("../Output/OverviewSelCoeff_Bacheler.csv",row.names=1)
OverviewDFBach<-read.csv("../Output/OverviewSelCoeff_Bacheler.csv",row.names=1)
OverviewDFBach$StanfordFreqs<-t(read.csv("subtypeB-frequencies_stanford_pr_rt_naive.csv"))[1:length(OverviewDFBach[,1])]
synsites<-which(OverviewDFBach$TypeOfSite=="syn"&OverviewDFBach$num>39&consensusA==consensusB&consensusC==consensusB)
nonsynsites<-which(OverviewDFBach$TypeOfSite=="nonsyn"&OverviewDFBach$num>39&consensusA==consensusB&consensusC==consensusB)
R2BachStanford<-cor.test(OverviewDFBach$colMeansTs0[c(synsites,nonsynsites)],OverviewDFBach$StanfordFreqs[c(synsites,nonsynsites)])$estimate
synsites<-which(OverviewDFBach$TypeOfSite=="syn"&OverviewDFBach$num>39&consensusA==consensusB&consensusC==consensusB)
nonsynsites<-which(OverviewDFBach$TypeOfSite=="nonsyn"&OverviewDFBach$num>39&consensusA==consensusB&consensusC==consensusB)
R2BachStanford<-cor.test(OverviewDFBach$colMeansTs0[c(synsites,nonsynsites)],OverviewDFBach$StanfordFreqs[c(synsites,nonsynsites)])$estimate
OverviewDFBach$colMeansTs0[c(synsites,nonsynsites)]
synsites
nonsynsites
head(OverviewDFBach)
R2BachStanford<-cor.test(OverviewDFBach$MeanFreq[c(synsites,nonsynsites)],OverviewDFBach$StanfordFreqs[c(synsites,nonsynsites)])$estimate
cor.test(OverviewDFBach$MeanFreq[c(synsites,nonsynsites)],OverviewDFBach$StanfordFreqs[c(synsites,nonsynsites)])
cor.test(OverviewDFBach$MeanFreq[c(synsites,nonsynsites)],OverviewDFBach$StanfordFreqs[c(synsites,nonsynsites)])^2
cor.test(OverviewDFBach$MeanFreq[c(synsites,nonsynsites)],OverviewDFBach$StanfordFreqs[c(synsites,nonsynsites)])$estimate^2
cor.test(OverviewDFBach$MeanFreq[c(synsites,nonsynsites)],OverviewDFBach$StanfordFreqs[c(synsites,nonsynsites)])
cor.test(OverviewDFBach$MeanFreq[c(synsites,nonsynsites)],OverviewDFBach$StanfordFreqs[c(synsites,nonsynsites)],method="s")
cor.test(OverviewDFBach$MeanFreq[c(synsites,nonsynsites)],OverviewDFBach$StanfordFreqs[c(synsites,nonsynsites)],method="p")
0.7616183^2
cor.test(OverviewDFBach$MeanFreq[c(synsites,nonsynsites)],OverviewDFBach$StanfordFreqs[c(synsites,nonsynsites)],method="s")
cor.test(OverviewDFBach$MeanFreq[c(synsites,nonsynsites)],OverviewDFBach$StanfordFreqs[c(synsites,nonsynsites)],method="s")$estimate^2
OverviewDFBach$StanfordFreqs[c(synsites,nonsynsites)]*(1-OverviewDFBach$StanfordFreqs[c(synsites,nonsynsites)]),method="s")
OverviewDFBach$MeanFreq[c(synsites,nonsynsites)]*(1-OverviewDFBach$MeanFreq[c(synsites,nonsynsites)])
OverviewDFBach$StanfordFreqs[c(synsites,nonsynsites)]*(1-OverviewDFBach$StanfordFreqs[c(synsites,nonsynsites)])
cor.test(OverviewDFBach$MeanFreq[c(synsites,nonsynsites)]*(1-OverviewDFBach$MeanFreq[c(synsites,nonsynsites)]),
OverviewDFBach$StanfordFreqs[c(synsites,nonsynsites)]*(1-OverviewDFBach$StanfordFreqs[c(synsites,nonsynsites)]),method="s")
0.7616182^2
cor.test(OverviewDFBach$MeanFreq[c(nonsynsites)],OverviewDFBach$StanfordFreqs[c(nonsynsites)],method="s")
cor.test(OverviewDFBach$MeanFreq[c(synsites)],OverviewDFBach$StanfordFreqs[c(synsites)],method="s")
cor.test(OverviewDFBach$MeanFreq[c(nonsynsites)],OverviewDFBach$StanfordFreqs[c(nonsynsites)],method="p")
cor.test(OverviewDFBach$MeanFreq[c(synsites)],OverviewDFBach$StanfordFreqs[c(synsites)],method="p")
OverviewDFZanini<-read.csv("../Output/OverviewSelCoeffZanini.csv",row.names=1)
OverviewDFZanini$StanfordFreqs<-t(read.csv("subtypeB-frequencies_stanford_pr_rt_naive.csv"))[1:length(OverviewDFBach[,1])]
OverviewDFLehman<-read.csv("../Output/OverviewSelCoeffLehman.csv",row.names=1)
OverviewDFLehman$StanfordFreqs<-t(read.csv("subtypeB-frequencies_stanford_pr_rt_naive.csv"))[1:length(OverviewDFBach[,1])]
synsites<-which(OverviewDFBach$TypeOfSite=="syn"&OverviewDFBach$num>39&consensusA==consensusB&consensusC==consensusB)
nonsynsites<-which(OverviewDFBach$TypeOfSite=="nonsyn"&OverviewDFBach$num>39&consensusA==consensusB&consensusC==consensusB)
stopsites<-which(OverviewDFBach$TypeOfSite=="stop"&OverviewDFBach$num>39&consensusA==consensusB&consensusC==consensusB)
length(synsites)
length(nonsynsites)
length(stopsites)
206+531+26
length(which(consensusA==consensusB&consensusC==consensusB))
head(consensusfasta)
head(consensusfasta[,1:10])
head(consensusfasta[,1:10],10)
consensusfasta[,1:10]
consensus01AE<-consensusfasta[which(row.names(consensusfasta)=="CONSENSUS_01_AE"), polstart:(polstart+983)]
which(OverviewDFBach$TypeOfSite!="res"&consensusC==consensusB&consensusB==consensus01AE&OverviewDFBach$num>39)
length(which(OverviewDFBach$TypeOfSite!="res"&consensusC==consensusB&consensusB==consensus01AE&OverviewDFBach$num>39))
length(which(OverviewDFBach$TypeOfSite!="res"&consensusC==consensusB&OverviewDFBach$num>39))
length(which(OverviewDFBach$TypeOfSite!="res"&OverviewDFBach$num>39))
cor.test(OverviewDFZanini$MeanFreq[c(synsites,nonsynsites)],OverviewDFZanini$StanfordFreqs[c(synsites,nonsynsites)],method="s")
OverviewDFZanini$MeanFreq[c(synsites,nonsynsites)]
head(OverviewDFZanini)
cor.test(OverviewDFZanini$colMeansTsZanini[c(synsites,nonsynsites)],OverviewDFZanini$StanfordFreqs[c(synsites,nonsynsites)],method="s")
cor.test(OverviewDFZanini$colMeansTsZanini[c(synsites,nonsynsites)],OverviewDFBach$MeanFreq[c(synsites,nonsynsites)],method="s")
NumseqsBach
setwd("~/Documents/Git/bachelerProject/SimulationsEstimatingSelCoeffSims/Scripts")
source("../../Rscripts/baseRscript.R")
listfastafiles<-list.files("../../Data/BachelerFiles//FASTAfiles")
lengthallsequenceslist<-c()
NumseqsBach<-c()
for (i in 1:length(listfastafiles)){ #for each fastafile
filename=paste("../../Data/BachelerFiles/FASTAfiles/",substr(listfastafiles[i],1,6),".fasta",sep="")
patfasta<-read.dna(filename, format = "fasta",as.character=TRUE) #read the file
NumseqsBach<-c(NumseqsBach,nrow(patfasta))
}
NumseqsBach<-NumseqsBach[NumseqsBach>1] #remove patients with just one sequence
sum(NumseqsBach)
media(NumseqsBach)
median(NumseqsBach)
OverviewDF[OverviewDF$EstSelCoeff==1,]
length(which(OverviewDF$EstSelCoeff==1))
length(which(OverviewDF$EstSelCoeff==1&OverviewDF$TypeOfSite%in%c("syn","nonsyn","stop")))
length(which(OverviewDF$EstSelCoeff<1&OverviewDF$TypeOfSite%in%c("syn","nonsyn","stop")))
length(which(OverviewDF$EstSelCoeff<1&OverviewDF$TypeOfSite%in%c("syn","nonsyn","stop","overlap")))
length(which(OverviewDF$EstSelCoeff==1&OverviewDF$TypeOfSite%in%c("syn","nonsyn","stop","overlap")))
51/870
length(which(OverviewDF$TypeOfSite%in%c("syn","nonsyn","stop")))
(870-51)/870
length(which(OverviewDF$EstSelCoeff==1&OverviewDF$TypeOfSite%in%c(stop")))
ç
çç
}
}
)
)
length(which(OverviewDF$EstSelCoeff==1&OverviewDF$TypeOfSite%in%c("stop")))
28/51
length(which(OverviewDF$EstSelCoeff==1&OverviewDF$TypeOfSite%in%c("syn")))
length(which(OverviewDF$EstSelCoeff==1&OverviewDF$TypeOfSite%in%c("nonsyn")))
OverviewDF[which(OverviewDF$EstSelCoeff==1&OverviewDF$TypeOfSite%in%c("nonsyn")),]
OverviewDF$WTnt[which(OverviewDF$EstSelCoeff==1&OverviewDF$TypeOfSite%in%c("nonsyn"))]
table(OverviewDF$WTnt[which(OverviewDF$EstSelCoeff==1&OverviewDF$TypeOfSite%in%c("nonsyn"))])
OverviewDF[OverviewDF$TypeOfSite=="res"]
OverviewDF[OverviewDF$TypeOfSite=="res",]
t
source('./baseRscript.R')
library(scales)
library(plotrix)
setwd("~/Documents/Git/bachelerProject/Rscripts")
source('./baseRscript.R')
library(scales)
library(plotrix)
read.table("../Output/freqPatTs_Zanini.csv",sep=",",header=TRUE,row.names=1)->freqPatTsZanini
colMeansTsZanini<-apply(freqPatTsZanini, 2 , mean, na.rm=TRUE)
numsitesZanini<-length(colMeansTsZanini)
OverviewDFZanini<-data.frame(num=1:numsitesZanini,colMeansTsZanini)
OverviewDFZanini$TypeOfSite<-TypeOfSite[1:numsitesZanini]
OverviewDFZanini$WTnt<-consensusB[1:numsitesZanini]
length(OverviewDFZanini$TypeOfSite)
read.csv("../Data/HIVMutRates/HIVMutRates.csv")->mutrates
OverviewDFZanini$TSmutrate<-0
OverviewDFZanini$TSmutrate[OverviewDFZanini$WTnt=="a"]<-mutrates$Probability[mutrates$Nucleotide.substitution=="AG"]
OverviewDFZanini$TSmutrate[OverviewDFZanini$WTnt=="c"]<-mutrates$Probability[mutrates$Nucleotide.substitution=="CU"]
OverviewDFZanini$TSmutrate[OverviewDFZanini$WTnt=="g"]<-mutrates$Probability[mutrates$Nucleotide.substitution=="GA"]
OverviewDFZanini$TSmutrate[OverviewDFZanini$WTnt=="t"]<-mutrates$Probability[mutrates$Nucleotide.substitution=="UC"]
for (i in 1:984){
OverviewDFZanini$EstSelCoeff[i] = EstimatedS(OverviewDFZanini$TSmutrate[i],OverviewDFZanini$colMeansTsZanini[i])}
OverviewDFZanini$WTAA<-""
for (i in 1:numsitesZanini){
if (i%%3==1) OverviewDFZanini$WTAA[i] = seqinr::translate(OverviewDFZanini$WTnt[c(i,i+1,i+2)])
if (i%%3==2) OverviewDFZanini$WTAA[i] = seqinr::translate(OverviewDFZanini$WTnt[c(i-1,i,i+1)])
if (i%%3==0) OverviewDFZanini$WTAA[i] = seqinr::translate(OverviewDFZanini$WTnt[c(i-2,i-1,i)])
}
#MUT AAs
for (i in 1:numsitesZanini){
if (i%%3==1) OverviewDFZanini$MUTAA[i] = seqinr::translate(c(transition(OverviewDFZanini$WTnt[i]),OverviewDFZanini$WTnt[c(i+1,i+2)]))
if (i%%3==2) OverviewDFZanini$MUTAA[i] = seqinr::translate(c(OverviewDFZanini$WTnt[c(i-1)],transition(OverviewDFZanini$WTnt[i]),OverviewDFZanini$WTnt[c(i+1)]))
if (i%%3==0) OverviewDFZanini$MUTAA[i] = seqinr::translate(c(OverviewDFZanini$WTnt[c(i-2,i-1)],transition(OverviewDFZanini$WTnt[i])))
}
which(!(consensusB == consensusC == consensus01AE))
which(consensusB == consensusC == consensus01AE)
which(consensusB != consensusC | consensusC != consensus01AE)
OverviewDFZanini$TypeOfSite[1:39]<-"overlap"
OverviewDFZanini$TypeOfSite[which(consensusB != consensusC | consensusC != consensus01AE)]<-"exclude"
write.csv(OverviewDFZanini,"../Output/OverviewSelCoeffZanini.csv")
length(which(OverviewDFZanini$TypeOfSite%in%c("overlap","exclude")))
table(OverviewDFZanini$TypeOfSite)
532+200+26
dim(freqPatTsZanini)
